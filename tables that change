SELECT 'INSERT INTO  OGGADMIN.DATE_DML  SELECT A.TABLE_NAME,
       (SELECT MAX (ORA_ROWSCN) FROM '||A.OWNER||'.'||A.TABLE_NAME||')    MSCN,
       (SELECT SCN_TO_TIMESTAMP (MAX (ORA_ROWSCN)) FROM '||A.OWNER||'.'||A.TABLE_NAME||') DMSCN,
       A.NUM_ROWS
  FROM DBA_TABLES A WHERE A.TABLE_NAME='''||A.TABLE_NAME||''';'

 FROM DBA_TABLES A
WHERE A.OWNER IN('VAD')
AND A.TABLE_NAME NOT IN  (SELECT TABLE_NAME
                  FROM DBA_TABLES DT
                 WHERE DT.TABLE_NAME LIKE ('SYS%')
                 UNION 
                 SELECT TABLE_NAME
                  FROM DBA_TABLES DT
                 WHERE DT.TABLE_NAME LIKE ('ADM_LOG_%')
                 
                 )
AND A.NUM_ROWS IS NOT NULL
 ORDER BY A.NUM_ROWS DESC ;
 
